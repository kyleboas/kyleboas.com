{% if site.google_analytics %}
<script>
document.addEventListener("DOMContentLoaded", function() {
    console.log("Document loaded");

    // Function to get a cookie by name
    function getCookie(name) {
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) {
            console.log(`Cookie "${name}" found with value: ${parts.pop().split(';').shift()}`);
            return parts.pop().split(';').shift();
        }
        console.log(`Cookie "${name}" not found`);
    }

    // Check if the cookie "cookie-notice-dismissed" is set
    if (getCookie("cookie-notice-dismissed")) {
        console.log("Cookie 'cookie-notice-dismissed' is set. Loading GoatCounter script.");

        // Create a script element
        const script = document.createElement("script");
        script.src = "https://gc.zgo.at/count.js";
        script.async = true;
        script.dataset.goatcounter = "https://tacticsjournal.goatcounter.com/count";

        // Append the script to the body or head
        document.head.appendChild(script);

        console.log("GoatCounter script added.");
    } else {
        console.log("Cookie 'cookie-notice-dismissed' is not set. GoatCounter script will not be loaded.");
    }
});
</script>
{% endif %}
